!function(e,t,r,i){"use strict";var n=function(e){var t={},i=e.serializeArray();return r.each(i,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},s=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},o=function(e,t){var i={},n=0;e.find("img").each(function(){var e=this,t=r(this);if(e.src){var n=e.complete&&e.naturalWidth>=0||4===e.readyState||"complete"===e.readyState;n||i[e.src]||(i[e.src]={origin:e,$origin:t,proxy:!1})}});var s=function(){n--,0==n&&(t(),i=null)};for(var o in i)i.hasOwnProperty(o)&&!i[o].proxy&&!function(e){var t=new Image;n++,i[e].proxy=t,t.onload=function(){i&&(delete i[e],s())},t.onerror=function(){i&&(delete i[e],s())},t.src=e}(o);0==n&&t()},a=!!e.history&&!!e.history.pushState,p=function(){this.properties={initiated:!1,source_name:"PageBlend",event_namespace:"PageBlend",event_listeners:{},images_cache:{},processing:!1,element:!1,target:"",url:""},this.settings={delay:600,timeout:1e4,wait_for_images:!0,default_target:!1},i&&this.initiate()};p.prototype.process=function(i,n,p,l,c){var u=this;if(!a)return i&&(c?e.location.assign(i):e.location.replace(i)),!1;i=i||"",n=n&&"POST"===n.toUpperCase()?"POST":"GET",p=p||{},c=c||"undefined"==typeof c?!0:!1;var f=e.location.protocol+"//"+e.location.host;if(i.match(/^http|https:\/\//)&&!i.match(new RegExp("^"+s(f)))&&!i.match(new RegExp("^"+s(f.replace(/^http:\/\//,"https://")))))return!1;u.properties.processing&&u.properties.processing.abort&&u.properties.processing.abort(),u.properties.url=i,u.properties.target=l?l:u.settings.default_target,u.trigger("before_change",u.properties.url,u.properties.element),i=u.properties.url,l=u.properties.target;var h=!1,v=!1,g=(setTimeout(function(){v=!0,h&&h()},u.settings.delay),function(n,s){var a=!0;if(n){n=n.replace("<body","<div").replace("</body","</div");var p=r(n),f=p.filter("div:first").eq(0),h=l?r(l).eq(0):{length:0},v=l?f.find(l).eq(0):{length:0};if(h.length||v.length||(h=r(".page-blend-container").eq(0),v=f.find(".page-blend-container").eq(0)),h.length||v.length||(h=r("body").eq(0),v=f),h.length&&v.length){var g=function(){var r={target:l,source:u.properties.source_name},n=p.filter("title").eq(0).text()||t.title;t.title=n,c&&e.history.pushState(r,n,i),h.html(v.html()),u.properties.element=!1,u.properties.url="",u.trigger("after_change",s,i,v.get(0),h.get(0))};u.settings.wait_for_images?o(v,g):g()}else c?e.location.assign(i):e.location.replace(i);a=!1}a&&u.trigger("after_change",s,i,!1,!1)});return u.properties.processing=r.ajax({url:i,type:n,data:p,dataType:"html",async:!0,complete:function(e,t){v?g(e.responseText,t):h=function(){g(e.responseText,t)},u.properties.processing=!1}}),!0},p.prototype.initiate=function(){var i=this;if(!a)return i;if(!i.properties.initiated){r("html").on("click."+i.properties.event_namespace,"a",function(e){var t=r(this),n=t.attr("href"),s=!1,o=!1;r.each(t.add(t.parents()).toArray().reverse(),function(){var e=r(this),t=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof t&&""!==t&&(s=t),"undefined"!=typeof i&&""!==i&&(o=i)}),i.properties.element=this,!s&&n&&!n.match(/^(?:javascript:|#)/)&&i.process(n,"GET",!1,o)&&e.preventDefault()}).on("submit."+i.properties.event_namespace,"form",function(e){var t=r(this),s=t.attr("action"),o=t.attr("method"),a=!1,p=!1;r.each(t.add(t.parents()).toArray().reverse(),function(){var e=r(this),t=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof t&&""!==t&&(a=t),"undefined"!=typeof i&&""!==i&&(p=i)}),i.properties.element=this,!a&&s&&i.process(s,o,n(t),p)&&e.preventDefault()}),r(e).on("popstate."+i.properties.event_namespace,function(t){t.originalEvent.state&&t.originalEvent.state.source===i.properties.source_name&&i.process(e.location.href,!1,!1,t.originalEvent.state.target?t.originalEvent.state.target:!1,!1)});var s=e.history.state;if(!s||s.source!==i.properties.source_name){var o=!1;s?"object"!=typeof s||s instanceof Array||(s.source=i.properties.source_name,o=!0):(s={source:i.properties.source_name},o=!0),o&&e.history.replaceState(s,t.title,e.location.href)}i.properties.initiated=!0}return i},p.prototype.uninitiate=function(){var t=this;return r("html").off("."+t.properties.event_namespace),r(e).off("."+t.properties.event_namespace),t.properties.initiated=!1,t},p.prototype.reinitiate=function(){var e=this;return e.uninitiate(),e.initiate(),e},p.prototype.trigger=function(e){var t=this,r=Array.prototype.slice.call(arguments,1),i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(t.properties.event_listeners[n])for(var o in t.properties.event_listeners[n])if(t.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))for(var a=0;a<t.properties.event_listeners[n][o].length;a++)t.properties.event_listeners[n][o][a]&&t.properties.event_listeners[n][o][a].apply(t,r);return t},p.prototype.on=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:"_default";return r.properties.event_listeners[n]||(r.properties.event_listeners[n]={}),r.properties.event_listeners[n][s]||(r.properties.event_listeners[n][s]=[]),r.properties.event_listeners[n][s].push(t),r},p.prototype.off=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(r.properties.event_listeners[n])for(var o in r.properties.event_listeners[n])if(r.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))if(t)for(var a=0;a<r.properties.event_listeners[n][o].length;a++)r.properties.event_listeners[n][o][a]===t&&(r.properties.event_listeners[n][o].splice(a,1),a--);else r.properties.event_listeners[n][o]=[];return r},r.PageBlend=new p}(window,document,jQuery,!0);