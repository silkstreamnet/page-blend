!function(e,t,r){"use strict";var i=function(e){var r={},i=e.serializeArray();return t.each(i,function(){void 0!==r[this.name]?(r[this.name].push||(r[this.name]=[r[this.name]]),r[this.name].push(this.value||"")):r[this.name]=this.value||""}),r},n=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},s=function(e,r){var i={},n=0;e.find("img").each(function(){var e=this,r=t(this);if(e.src){var n=e.complete&&e.naturalWidth>=0||4===e.readyState||"complete"===e.readyState;n||i[e.src]||(i[e.src]={origin:e,$origin:r,proxy:!1})}});var s=function(){n--,0==n&&(r(),i=null)};for(var o in i)i.hasOwnProperty(o)&&!i[o].proxy&&!function(e){var t=new Image;n++,i[e].proxy=t,t.onload=function(){i&&(delete i[e],s())},t.onerror=function(){i&&(delete i[e],s())},t.src=e}(o);0==n&&r()},o=!!e.history&&!!e.history.pushState,p=function(){this.properties={initiated:!1,event_namespace:"PageBlend",event_listeners:{},images_cache:{},processing:!1,element:!1,url:""},this.settings={delay:600,timeout:1e4,wait_for_images:!0},r&&this.initiate()};p.prototype.process=function(r,i,p,a){var l=this;if(!o)return!1;r=r||"",p=p&&"POST"===p.toUpperCase()?"POST":"GET",i=i||!1,a=a||{};var c=e.location.protocol+"//"+e.location.host;if(r.match(/^http|https:\/\//)&&!r.match(new RegExp("^"+n(c)))&&!r.match(new RegExp("^"+n(c.replace(/^http:\/\//,"https://")))))return!1;l.properties.processing&&l.properties.processing.abort&&l.properties.processing.abort(),l.properties.url=r,l.trigger("before_change",l.properties.url,l.properties.element),r=l.properties.url;var h=!1,f=!1,u=(setTimeout(function(){f=!0,h&&h()},l.settings.delay),function(n,o){var p=!0;if(n){n=n.replace("<body","<div").replace("</body","</div");var a=t(n),c=a.filter("div:first").eq(0),h=i?t(i).eq(0):{length:0},f=i?c.find(i).eq(0):{length:0};if(h.length||f.length||(h=t(".page-blend-container").eq(0),f=c.find(".page-blend-container").eq(0)),h.length||f.length||(h=t("body").eq(0),f=c),h.length&&f.length){var u=function(){var t=history.state,i=a.filter("title").eq(0).text()||document.title;document.title=i,e.history.pushState(t,i,r),h.html(f.html()),l.properties.element=!1,l.properties.url="",l.trigger("after_change",o,r,f.get(0),h.get(0))};l.settings.wait_for_images?s(f,u):u()}else e.location.href=r;p=!1}p&&l.trigger("after_change",o,r,!1,!1)});return l.properties.processing=t.ajax({url:r,type:p,data:a,dataType:"html",async:!0,complete:function(e,t){f?u(e.responseText,t):h=function(){u(e.responseText,t)},l.properties.processing=!1}}),!0},p.prototype.initiate=function(){var e=this;o&&(e.properties.initiated||(t("html").on("click."+e.properties.event_namespace,"a",function(r){var i=t(this),n=i.attr("href"),s=!1,o="";t.each(i.add(i.parents()).toArray().reverse(),function(){var e=t(this),r=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof r&&""!==r&&(s=r),"undefined"!=typeof i&&""!==i&&(o=i)}),e.properties.element=this,!s&&n&&e.process(n,o)&&r.preventDefault()}).on("submit."+e.properties.event_namespace,"form",function(r){var n=t(this),s=n.attr("action"),o=n.attr("method"),p=!1,a="";t.each(n.add(n.parents()).toArray().reverse(),function(){var e=t(this),r=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof r&&""!==r&&(p=r),"undefined"!=typeof i&&""!==i&&(a=i)}),e.properties.element=this,!p&&s&&e.process(s,a,o,i(n))&&r.preventDefault()}),e.properties.initiated=!0))},p.prototype.clear=function(){var e=this;t("html").off("."+e.properties.event_namespace),e.properties.initiated=!1},p.prototype.reinitiate=function(){this.clear(),this.initiate()},p.prototype.trigger=function(e){var t=this,r=Array.prototype.slice.call(arguments,1),i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(t.properties.event_listeners[n])for(var o in t.properties.event_listeners[n])if(t.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))for(var p=0;p<t.properties.event_listeners[n][o].length;p++)t.properties.event_listeners[n][o][p]&&t.properties.event_listeners[n][o][p].apply(t,r)},p.prototype.on=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:"_default";r.properties.event_listeners[n]||(r.properties.event_listeners[n]={}),r.properties.event_listeners[n][s]||(r.properties.event_listeners[n][s]=[]),r.properties.event_listeners[n][s].push(t)},p.prototype.off=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(r.properties.event_listeners[n])for(var o in r.properties.event_listeners[n])if(r.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))if(t)for(var p=0;p<r.properties.event_listeners[n][o].length;p++)r.properties.event_listeners[n][o][p]===t&&(r.properties.event_listeners[n][o].splice(p,1),p--);else r.properties.event_listeners[n][o]=[]},t.PageBlend=new p}(window,jQuery,!0);