!function(e,t,r){"use strict";var i=function(e){var r={},i=e.serializeArray();return t.each(i,function(){void 0!==r[this.name]?(r[this.name].push||(r[this.name]=[r[this.name]]),r[this.name].push(this.value||"")):r[this.name]=this.value||""}),r},n=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},s=function(e,r){var i={},n=0;e.find("img").each(function(){var e=this,r=t(this);if(e.src){var n=e.complete&&e.naturalWidth>=0||4===e.readyState||"complete"===e.readyState;n||i[e.src]||(i[e.src]={origin:e,$origin:r,proxy:!1})}});var s=function(){n--,0==n&&(r(),i=null)};for(var o in i)i.hasOwnProperty(o)&&!i[o].proxy&&!function(e){var t=new Image;n++,i[e].proxy=t,t.onload=function(){i&&(delete i[e],s())},t.onerror=function(){i&&(delete i[e],s())},t.src=e}(o);0==n&&r()},o=!!e.history&&!!e.history.pushState,p=function(){this.properties={initiated:!1,event_namespace:"PageBlend",event_listeners:{},images_cache:{},processing:!1,element:!1,target:"",url:""},this.settings={delay:600,timeout:1e4,wait_for_images:!0},r&&this.initiate()};p.prototype.process=function(r,i,p,a,l){var c=this;if(!o)return!1;r=r||"",p=p&&"POST"===p.toUpperCase()?"POST":"GET",i=!!i,a=a||{},l=l||"undefined"==typeof l?!0:!1;var f=e.location.protocol+"//"+e.location.host;if(r.match(/^http|https:\/\//)&&!r.match(new RegExp("^"+n(f)))&&!r.match(new RegExp("^"+n(f.replace(/^http:\/\//,"https://")))))return!1;c.properties.processing&&c.properties.processing.abort&&c.properties.processing.abort(),c.properties.url=r,c.properties.target=i,c.trigger("before_change",c.properties.url,c.properties.element),r=c.properties.url,i=c.properties.target;var h=!1,v=!1,u=(setTimeout(function(){v=!0,h&&h()},c.settings.delay),function(n,o){var p=!0;if(n){n=n.replace("<body","<div").replace("</body","</div");var a=t(n),f=a.filter("div:first").eq(0),h=i?t(i).eq(0):{length:0},v=i?f.find(i).eq(0):{length:0};if(h.length||v.length||(h=t(".page-blend-container").eq(0),v=f.find(".page-blend-container").eq(0)),h.length||v.length||(h=t("body").eq(0),v=f),h.length&&v.length){var u=function(){var t={target:i,source:"PageBlend"},n=a.filter("title").eq(0).text()||document.title;document.title=n,l&&e.history.pushState(t,n,r),h.html(v.html()),c.properties.element=!1,c.properties.url="",c.trigger("after_change",o,r,v.get(0),h.get(0))};c.settings.wait_for_images?s(v,u):u()}else e.location.href=r;p=!1}p&&c.trigger("after_change",o,r,!1,!1)});return c.properties.processing=t.ajax({url:r,type:p,data:a,dataType:"html",async:!0,complete:function(e,t){v?u(e.responseText,t):h=function(){u(e.responseText,t)},c.properties.processing=!1}}),!0},p.prototype.initiate=function(){var r=this;o&&(r.properties.initiated||(t("html").on("click."+r.properties.event_namespace,"a",function(e){var i=t(this),n=i.attr("href"),s=!1,o="";t.each(i.add(i.parents()).toArray().reverse(),function(){var e=t(this),r=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof r&&""!==r&&(s=r),"undefined"!=typeof i&&""!==i&&(o=i)}),r.properties.element=this,!s&&n&&!n.match(/^(?:javascript:|#)/)&&r.process(n,o)&&e.preventDefault()}).on("submit."+r.properties.event_namespace,"form",function(e){var n=t(this),s=n.attr("action"),o=n.attr("method"),p=!1,a="";t.each(n.add(n.parents()).toArray().reverse(),function(){var e=t(this),r=e.data("pb-disable"),i=e.data("pb-target");"undefined"!=typeof r&&""!==r&&(p=r),"undefined"!=typeof i&&""!==i&&(a=i)}),r.properties.element=this,!p&&s&&r.process(s,a,o,i(n))&&e.preventDefault()}),t(e).on("popstate."+r.properties.event_namespace,function(t){t.originalEvent.state&&"PageBlend"===t.originalEvent.state.source&&r.process(e.location.href,t.originalEvent.state.target?t.originalEvent.state.target:!1,!1,!1,!1)}),r.properties.initiated=!0))},p.prototype.uninitiate=function(){var r=this;t("html").off("."+r.properties.event_namespace),t(e).off("."+r.properties.event_namespace),r.properties.initiated=!1},p.prototype.reinitiate=function(){this.clear(),this.initiate()},p.prototype.trigger=function(e){var t=this,r=Array.prototype.slice.call(arguments,1),i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(t.properties.event_listeners[n])for(var o in t.properties.event_listeners[n])if(t.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))for(var p=0;p<t.properties.event_listeners[n][o].length;p++)t.properties.event_listeners[n][o][p]&&t.properties.event_listeners[n][o][p].apply(t,r)},p.prototype.on=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:"_default";r.properties.event_listeners[n]||(r.properties.event_listeners[n]={}),r.properties.event_listeners[n][s]||(r.properties.event_listeners[n][s]=[]),r.properties.event_listeners[n][s].push(t)},p.prototype.off=function(e,t){var r=this,i=e.split(".",2),n=i[0],s=i[1]?i[1]:!1;if(r.properties.event_listeners[n])for(var o in r.properties.event_listeners[n])if(r.properties.event_listeners[n].hasOwnProperty(o)&&(s===!1||s===o))if(t)for(var p=0;p<r.properties.event_listeners[n][o].length;p++)r.properties.event_listeners[n][o][p]===t&&(r.properties.event_listeners[n][o].splice(p,1),p--);else r.properties.event_listeners[n][o]=[]},t.PageBlend=new p}(window,jQuery,!0);